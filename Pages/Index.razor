@page "/"
@inject IJSRuntime Js

<PageTitle>Index</PageTitle>

@((MarkupString)mdHtml)

@code {

    string mdStr = 
@"

# [Home Page](https://blazor.masastack.com)

## Upgrading from v0.4.x to v0.5.x

v0.5.x contains non backwards compatible breaking changes, the following changes:

### CSS

Use `masa-blazor.min.css` instead of `masa-blazor.css` and `masa-extend-blazor.css`.

### API of injecting custom i18n

The old api in v0.4.x:

```csharp
services.AddMasaBlazor();
services.AddMasaI18nForServer();
services.AddMasaI18nForWasmAsync(); // in WASM
```

Change to：

```csharp
services.AddMasaBlazor().AddI18nForServer();
await services.AddMasaBlazor().AddI18nForWasmAsync(); // in WASM
```

And rename the **languageConfig.json** file to **supportedCultures.json** at the same time.
";

    string mdHtml;

    IJSObjectReference? MarkdownItJSObjectReference { get; set; }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            MarkdownItJSObjectReference = await Js.InvokeAsync<IJSObjectReference>("import", "./js/markdown-it-proxy.js");
            mdHtml = await Render(mdStr);
            StateHasChanged();
        }
    }

    private async Task<string> Render(string src)
    {
        return await MarkdownItJSObjectReference!.InvokeAsync<string>("render", src);
    }

}
